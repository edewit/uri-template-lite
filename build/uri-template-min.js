!function(p){function u(a){return encodeURIComponent(a).replace(v,escape)}function l(a){return a.replace(w,"\\$&")}function x(a,g,e){return a+(g||"&"==e?"=":"")+g}function m(a,g,e){a=a.map(g).filter(function(a){return"string"==typeof a});return a.length&&a.join(e)}function q(a,g){return a.replace(r,function(a,f,y){var b=s[f]||f,h=f&&","==b?encodeURI:u,d=(";"==b||"&"==b)&&x;return(a=m(y.split(","),function(a){var n=a!=(a=a.split("*")[0]),k=!n&&(k=a.split(":"),a=k[0],k[1]),c=g[a];if(null!=c){if("object"==
typeof c){if(Array.isArray(c)?c=m(c,h,n?d?b+a+"=":b:","):(k=n?"=":",",c=m(Object.keys(c),function(a){return h(a)+k+h(c[a])},n&&(d||"/"==b)?b:","),n&&(d=null)),!c)return}else c=h(k?c.slice(0,k):c);return d?d(a,c,b):c}},b))?"+"!=f?f+a:a:""!==a||"#"!=f&&"."!=f?"":f})}function t(a){this.init(this.template=a);this.expand=q.bind(this,a)}var v=/[\]\[:\/?#@!$&()*+,;=']/g,s={"":",","+":",","#":",","?":"&"},w=/[.*+?^=!:${}()|\[\]\/\\]/g,r=/\{([+#.\/;?&]?)((?:[\w%.]+(\*|:\d)?,?)+)\}/g,z=new RegExp(r.source+
"|.[^{]*?","g");p.expand=q;t.prototype={init:function(a){var g=0,e="",f={};a="^"+a.replace(z,function(a,b,h){if(!h)return l(a);var d=s[b]||b,m=";"==d||"&"==d;a="(.+?)";e+='sep="'+d+'";';a=h.split(",").map(function(a){var b;a=a.replace(/(?:(\*)|:(\d+))$/,function(a,c,d){b=d;return""});var c="(.*?)";g++;if(b)c="((?:%..|.){1,"+b+"})",f[a]={pos:g,len:b};else if(b=f[a])c="(\\"+b.pos+".*?)";e+="t=(parts["+g+"]||'').split('"+d+"');";e+='out["'+a+'"]=t.length>1?t.map(decodeURIComponent):decodeURIComponent(t[0]);';
return m?"&"==d?l(a+"=")+c:l(a)+"(?:="+c+")?":c}).join(l(d));return("+"!=b?l(b):"")+a})+"$";this.re=new RegExp(a);this.fn=new Function("parts","var t,sep,eq,out={};"+e+";return out")},match:function(a){return(a=this.re.exec(a))&&this.fn(a)}};p.Template=t}(this.URI||(this.URI={}));
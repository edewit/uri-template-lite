!function(p){function u(a){return encodeURIComponent(a).replace(v,escape)}function w(a,f,g){return a+(f||"&"==g?"=":"")+f}function m(a,f,g){a=a.map(f).filter(function(a){return"string"==typeof a});return a.length&&a.join(g)}function q(a,f){return a.replace(r,function(a,d,l){var c=s[d]||d,h=d&&","==c?encodeURI:u,e=(";"==c||"&"==c)&&w;return(a=m(l.split(","),function(a){var n=a!=(a=a.split("*")[0]),k=!n&&(k=a.split(":"),a=k[0],k[1]),b=f[a];if(null!=b){if("object"==typeof b){if(Array.isArray(b)?b=m(b,
h,n?e?c+a+"=":c:","):(k=n?"=":",",b=m(Object.keys(b),function(a){return h(a)+k+h(b[a])},n&&(e||"/"==c)?c:","),n&&(e=null)),!b)return}else b=h(k?b.slice(0,k):b);return e?e(a,b,c):b}},c))?"+"!=d?d+a:a:""!==a||"#"!=d&&"."!=d?"":d})}function t(a){this.init(this.template=a);this.expand=q.bind(this,a)}function l(a){return a.replace(x,"\\$&")}var v=/[\]\[:\/?#@!$&()*+,;=']/g,s={"":",","+":",","#":",","?":"&"},x=/[.*+?^=!:${}()|\[\]\/\\]/g,r=/\{([+#.\/;?&]?)((?:[\w%.]+(\*|:\d)?,?)+)\}/g,y=new RegExp(r.source+
"|.[^{]*?","g");p.expand=q;t.prototype={init:function(a){var f=0,g="",d={};a="^"+a.replace(y,function(a,c,h){if(!h)return l(a);var e=s[c]||c,m=";"==e||"&"==e;a=h.split(",").map(function(a){var c="(.*?)",b=a==(a=a.split("*")[0])&&(b=a.split(":"),a=b[0],b[1]);f++;if(b)c="((?:%..|.){1,"+b+"})",d[a]={pos:f,len:b};else if(b=d[a])c="(\\"+b.pos+".*?)";g+="t=($["+f+"]||'').split('"+e+"').map(decodeURIComponent);";g+='o["'+a+'"]=t.length>1?t:t[0];';return m?"&"==e?l(a+"=")+c:l(a)+"(?:="+c+")?":c}).join(l(e));
return("+"!=c?l(c):"")+a})+"$";this.re=new RegExp(a);this.fn=new Function("$","var t,o={};"+g+"return o")},match:function(a){return(a=this.re.exec(a))&&this.fn(a)}};p.Template=t}(this.URI||(this.URI={}));